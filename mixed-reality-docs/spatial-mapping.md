---
title: Mappage spatial
description: Le mappage spatial fournit une représentation détaillée des surfaces réelles dans l’environnement autour du HoloLens.
author: mattzmsft
ms.author: mazeller
ms.date: 03/21/2018
ms.topic: article
keywords: mappage spatial, HoloLens, réalité mixte, reconstruction de surface, maille, SR
ms.openlocfilehash: 4914cf5b7864ecb2430a39af73729eb6dfc0e2bd
ms.sourcegitcommit: c4c293971bb3205a82121bbfb40d1ac52b5cb38e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/10/2019
ms.locfileid: "68937067"
---
# <a name="spatial-mapping"></a><span data-ttu-id="ee6b2-104">Mappage spatial</span><span class="sxs-lookup"><span data-stu-id="ee6b2-104">Spatial mapping</span></span>

<span data-ttu-id="ee6b2-105">Le mappage spatial fournit une représentation détaillée des surfaces réelles dans l’environnement autour du HoloLens, ce qui permet aux développeurs de créer une expérience de réalité mixte convaincante.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-105">Spatial mapping provides a detailed representation of real-world surfaces in the environment around the HoloLens, allowing developers to create a convincing mixed reality experience.</span></span> <span data-ttu-id="ee6b2-106">En fusionnant le monde réel avec le monde virtuel, une application peut faire paraître des hologrammes réels.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-106">By merging the real world with the virtual world, an application can make holograms seem real.</span></span> <span data-ttu-id="ee6b2-107">Les applications peuvent également être plus naturellement alignées sur les attentes des utilisateurs en fournissant des comportements et des interactions réels et familiers.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-107">Applications can also more naturally align with user expectations by providing familiar real-world behaviors and interactions.</span></span>

<br>

>[!VIDEO https://www.youtube.com/embed/zff2aQ1RaVo]

## <a name="device-support"></a><span data-ttu-id="ee6b2-108">Prise en charge des appareils</span><span class="sxs-lookup"><span data-stu-id="ee6b2-108">Device support</span></span>

<table>
<tr>
<th><span data-ttu-id="ee6b2-109">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="ee6b2-109">Feature</span></span></th><th style="width:150px"> <span data-ttu-id="ee6b2-110"><a href="hololens-hardware-details.md">HoloLens (1ère génération)</a></span><span class="sxs-lookup"><span data-stu-id="ee6b2-110"><a href="hololens-hardware-details.md">HoloLens (1st gen)</a></span></span></th><th style="width:150px"><span data-ttu-id="ee6b2-111">HoloLens 2</span><span class="sxs-lookup"><span data-stu-id="ee6b2-111">HoloLens 2</span></span></th><th style="width:150px"> <span data-ttu-id="ee6b2-112"><a href="immersive-headset-hardware-details.md">Casques immersifs</a></span><span class="sxs-lookup"><span data-stu-id="ee6b2-112"><a href="immersive-headset-hardware-details.md">Immersive headsets</a></span></span></th>
</tr><tr>
<td> <span data-ttu-id="ee6b2-113">Mappage spatial</span><span class="sxs-lookup"><span data-stu-id="ee6b2-113">Spatial mapping</span></span></td><td style="text-align: center;"> <span data-ttu-id="ee6b2-114">✔️</span><span class="sxs-lookup"><span data-stu-id="ee6b2-114">✔️</span></span></td><td style="text-align: center;"> <span data-ttu-id="ee6b2-115">✔️</span><span class="sxs-lookup"><span data-stu-id="ee6b2-115">✔️</span></span></td><td style="text-align: center;"></td>
</tr>
</table>



## <a name="conceptual-overview"></a><span data-ttu-id="ee6b2-116">Vue d’ensemble conceptuelle</span><span class="sxs-lookup"><span data-stu-id="ee6b2-116">Conceptual overview</span></span>

<span data-ttu-id="ee6b2-117">![Surfaces de filet couvrant une salle](images/SurfaceReconstruction.jpg)</span><span class="sxs-lookup"><span data-stu-id="ee6b2-117">![Mesh surfaces covering a room](images/SurfaceReconstruction.jpg)</span></span><br>
<span data-ttu-id="ee6b2-118">*Exemple de maillage de mappage spatial couvrant une salle*</span><span class="sxs-lookup"><span data-stu-id="ee6b2-118">*An example of a spatial mapping mesh covering a room*</span></span>

<span data-ttu-id="ee6b2-119">Les deux principaux types d’objets utilisés pour le mappage spatial sont l' «observateur de surface spatiale» et la «surface spatiale».</span><span class="sxs-lookup"><span data-stu-id="ee6b2-119">The two primary object types used for spatial mapping are the 'Spatial Surface Observer' and the 'Spatial Surface'.</span></span>

<span data-ttu-id="ee6b2-120">L’application fournit l’observateur de surface spatiale avec un ou plusieurs volumes englobants, pour définir les régions d’espace dans lesquelles l’application souhaite recevoir des données de mappage spatiale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-120">The application provides the Spatial Surface Observer with one or more bounding volumes, to define the regions of space in which the application wishes to receive spatial mapping data.</span></span> <span data-ttu-id="ee6b2-121">Pour chacun de ces volumes, le mappage spatial fournira à l’application un ensemble de surfaces spatiales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-121">For each of these volumes, spatial mapping will provide the application with a set of Spatial Surfaces.</span></span>

<span data-ttu-id="ee6b2-122">Ces volumes peuvent être fixes (à un emplacement fixe par rapport au monde réel) ou ils peuvent être attachés au HoloLens (ils se déplacent, mais ne pivotent pas avec le HoloLens à mesure qu’il progresse dans l’environnement).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-122">These volumes may be stationary (in a fixed location with respect to the real world) or they may be attached to the HoloLens (they move, but do not rotate, with the HoloLens as it moves through the environment).</span></span> <span data-ttu-id="ee6b2-123">Chaque surface spatiale décrit des surfaces réelles dans un petit volume d’espace, représentée sous la forme d’un maillage de triangles attaché à un [système de coordonnées spatiales](coordinate-systems.md)verrouillé.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-123">Each spatial surface describes real-world surfaces in a small volume of space, represented as a triangle mesh attached to a world-locked [spatial coordinate system](coordinate-systems.md).</span></span>

<span data-ttu-id="ee6b2-124">À mesure que le HoloLens recueille de nouvelles données sur l’environnement et que les modifications apportées à l’environnement se produisent, les surfaces spatiales s’affichent, disparaissent et changent.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-124">As the HoloLens gathers new data about the environment, and as changes to the environment occur, spatial surfaces will appear, disappear and change.</span></span>

## <a name="common-usage-scenarios"></a><span data-ttu-id="ee6b2-125">Scénarios d’utilisation courants</span><span class="sxs-lookup"><span data-stu-id="ee6b2-125">Common usage scenarios</span></span>

![Illustrations des scénarios courants d’utilisation du mappage spatial: Placement, occlusion, physique et navigation](images/sm-concepts-1000px.png)

### <a name="placement"></a><span data-ttu-id="ee6b2-127">Sélection élective</span><span class="sxs-lookup"><span data-stu-id="ee6b2-127">Placement</span></span>

<span data-ttu-id="ee6b2-128">Le mappage spatial offre aux applications la possibilité de présenter des formes d’interaction naturelles et familières à l’utilisateur. qu’est-ce qui pourrait être plus naturel que de placer votre téléphone sur le Bureau?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-128">Spatial mapping provides applications with the opportunity to present natural and familiar forms of interaction to the user; what could be more natural than placing your phone down on the desk?</span></span>

<span data-ttu-id="ee6b2-129">La limitation de l’emplacement des hologrammes (ou plus généralement, toute sélection d’emplacements spatiaux) à placer sur des surfaces fournit un mappage naturel entre le langage 3D (point dans l’espace) et le 2D (point sur la surface).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-129">Constraining the placement of holograms (or more generally, any selection of spatial locations) to lie on surfaces provides a natural mapping from 3D (point in space) to 2D (point on surface).</span></span> <span data-ttu-id="ee6b2-130">Cela réduit la quantité d’informations que l’utilisateur doit fournir à l’application et rend donc les interactions de l’utilisateur plus rapides, plus simples et plus précises.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-130">This reduces the amount of information the user needs to provide to the application and thus makes the user's interactions faster, easier and more precise.</span></span> <span data-ttu-id="ee6b2-131">Cela est particulièrement vrai, car la «distance» n’est pas une opération qui permet de communiquer physiquement avec d’autres personnes ou sur des ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-131">This is particularly true because 'distance away' is not something that we are used to physically communicating to other people or to computers.</span></span> <span data-ttu-id="ee6b2-132">Lorsque nous utilisons notre doigt, nous spécifions une direction, mais pas une distance.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-132">When we point with our finger, we are specifying a direction but not a distance.</span></span>

<span data-ttu-id="ee6b2-133">Il est important de noter que lorsqu’une application déduit la distance par rapport à la direction (par exemple en effectuant un raycast le long de la direction du regard de l’utilisateur pour trouver la surface spatiale la plus proche), cela doit donner des résultats que l’utilisateur est en mesure de prédire de manière fiable.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-133">An important caveat here is that when an application infers distance from direction (for example by performing a raycast along the user's gaze direction to find the nearest spatial surface), this must yield results that the user is able to reliably predict.</span></span> <span data-ttu-id="ee6b2-134">Dans le cas contraire, l’utilisateur perd sa logique de contrôle, ce qui peut rapidement devenir frustrant.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-134">Otherwise, the user will lose their sense of control and this can quickly become frustrating.</span></span> <span data-ttu-id="ee6b2-135">Une méthode qui permet d’effectuer cette opération consiste à exécuter plusieurs raycasts au lieu d’un seul.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-135">One method that helps with this is to perform multiple raycasts instead of just one.</span></span> <span data-ttu-id="ee6b2-136">Les résultats de l’agrégat doivent être plus lisses et plus prévisibles, moins susceptibles d’influencer les résultats «non-aberrants» temporaires (comme le peuvent être causés par des rayons passant par des trous minuscules ou des petits bits de géométrie dont l’utilisateur n’a pas conscience).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-136">The aggregate results should be smoother and more predictable, less susceptible to influence from transient 'outlier' results (as can be caused by rays passing through tiny holes or hitting small bits of geometry that the user is not aware of).</span></span> <span data-ttu-id="ee6b2-137">L’agrégation ou le lissage peuvent également être effectués au fil du temps. par exemple, vous pouvez limiter la vitesse maximale à laquelle un hologramme peut varier de distance par rapport à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-137">Aggregation or smoothing can also be performed over time; for example you can limit the maximum speed at which a hologram can vary in distance from the user.</span></span> <span data-ttu-id="ee6b2-138">Le simple fait de limiter la valeur de distance minimale et maximale peut également être utile, de sorte que l’hologramme qui est déplacé ne se déplace pas soudainement à la distance ou ne s’arrête pas dans le visage de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-138">Simply limiting the minimum and maximum distance value can also help, so the hologram being moved does not suddenly fly away into the distance or come crashing back into the user's face.</span></span>

<span data-ttu-id="ee6b2-139">Les applications peuvent également utiliser la forme et la direction des surfaces pour guider le placement de l’hologramme.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-139">Applications can also use the shape and direction of surfaces to guide hologram placement.</span></span> <span data-ttu-id="ee6b2-140">Une chaise holographique ne doit pas pénétrer dans les murs et doit être vidée avec le plancher même si elle est légèrement inégale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-140">A holographic chair should not penetrate through walls and should sit flush with the floor even if it is slightly uneven.</span></span> <span data-ttu-id="ee6b2-141">Ce genre de fonctionnalité s’appuie probablement sur l’utilisation de collisions physiques plutôt que simplement sur raycasts, mais des préoccupations similaires s’appliquent.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-141">This kind of functionality would likely rely upon the use of physics collisions rather than just raycasts, however similar concerns will apply.</span></span> <span data-ttu-id="ee6b2-142">Si l’hologramme est placé dans de nombreux petits polygones, comme les jambes d’un fauteuil, il peut être judicieux d’étendre la représentation physique de ces polygones à un autre plus large et plus lisse afin qu’ils soient plus en mesure de glisser-déplacer des surfaces spatiales sans avec SnagIt.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-142">If the hologram being placed has many small polygons that stick out, like the legs on a chair, it may make sense to expand the physics representation of those polygons to something wider and smoother so that they are more able to slide over spatial surfaces without snagging.</span></span>

<span data-ttu-id="ee6b2-143">À l’extrême, l’entrée de l’utilisateur peut être simplifiée entièrement et les surfaces spatiales peuvent être utilisées pour effectuer un placement d’hologramme entièrement automatique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-143">At its extreme, user input can be simplified away entirely and spatial surfaces can be used to perform entirely automatic hologram placement.</span></span> <span data-ttu-id="ee6b2-144">Par exemple, l’application peut placer un commutateur lumineux holographique quelque part sur le mur pour que l’utilisateur appuie sur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-144">For example, the application could place a holographic light-switch somewhere on the wall for the user to press.</span></span> <span data-ttu-id="ee6b2-145">Les mêmes avertissements sur la prévisibilité s’appliquent doublement. Si l’utilisateur est en mesure de contrôler le placement des hologrammes, mais que l’application ne place pas toujours les hologrammes à l’endroit où ils s’attendent (si le commutateur lumineux apparaît quelque part que l’utilisateur ne peut pas atteindre), cette expérience est frustrante.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-145">The same caveat about predictability applies doubly here; if the user expects control over hologram placement, but the application does not always place holograms where they expect (if the light-switch appears somewhere that the user cannot reach), then this will be a frustrating experience.</span></span> <span data-ttu-id="ee6b2-146">Il peut s’avérer plus difficile d’effectuer un placement automatique nécessitant une correction utilisateur, plutôt que de demander simplement à l’utilisateur de toujours se positionner. étant donné que le positionnement automatique réussi est *attendu*, la correction manuelle semble être une charge!</span><span class="sxs-lookup"><span data-stu-id="ee6b2-146">It can actually be worse to perform automatic placement that requires user correction some of the time, than to just require the user to always perform placement themselves; because successful automatic placement is *expected*, manual correction feels like a burden!</span></span>

<span data-ttu-id="ee6b2-147">Notez également que la capacité d’une application à utiliser des surfaces spatiales pour le placement dépend largement de l' [expérience d’analyse](spatial-mapping-design.md#the-environment-scanning-experience)de l’application.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-147">Note also that the ability of an application to use spatial surfaces for placement depends heavily on the application's [scanning experience](spatial-mapping-design.md#the-environment-scanning-experience).</span></span> <span data-ttu-id="ee6b2-148">Si une surface n’a pas été analysée, elle ne peut pas être utilisée pour le placement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-148">If a surface has not been scanned, then it cannot be used for placement.</span></span> <span data-ttu-id="ee6b2-149">Il revient à l’application de rendre cette opération claire pour l’utilisateur, afin de pouvoir analyser les nouvelles surfaces ou sélectionner un nouvel emplacement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-149">It is up to the application to make this clear to the user, so that they can either help scan new surfaces or select a new location.</span></span>

<span data-ttu-id="ee6b2-150">Le retour visuel à l’utilisateur revêt une importance primordiale pendant le positionnement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-150">Visual feedback to the user is of paramount importance during placement.</span></span> <span data-ttu-id="ee6b2-151">L’utilisateur doit savoir où l’hologramme est lié à la surface la plus proche avec des [effets de terre](spatial-mapping.md#visualization).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-151">The user needs to know where the hologram is in relation to the nearest surface with [grounding effects](spatial-mapping.md#visualization).</span></span> <span data-ttu-id="ee6b2-152">Ils doivent comprendre pourquoi le mouvement de leur hologramme est restreint (par exemple, en raison d’une collision avec une autre surface proche).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-152">They should understand why the movement of their hologram is being constrained (for example, due to collision with another nearby surface).</span></span> <span data-ttu-id="ee6b2-153">S’ils ne peuvent pas placer un hologramme à l’emplacement actuel, la rétroaction visuelle doit le faire clairement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-153">If they cannot place a hologram in the current location, then visual feedback should make it clear why not.</span></span> <span data-ttu-id="ee6b2-154">Par exemple, si l’utilisateur tente de placer un canapé dans le mur, les parties du canapé qui se trouvent derrière le mur doivent s’dans une couleur en colère.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-154">For example, if the user is trying to place a holographic couch stuck half-way into the wall, then the portions of the couch that are behind the wall should pulsate in an angry color.</span></span> <span data-ttu-id="ee6b2-155">À l’inverse, si l’application ne parvient pas à trouver une surface spatiale dans un emplacement où l’utilisateur peut voir une surface réelle, l’application doit le faire clairement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-155">Or conversely, if the application cannot find a spatial surface in a location where the user can see a real-world surface, then the application should make this clear.</span></span> <span data-ttu-id="ee6b2-156">L’absence évidente d’un effet de terre dans ce domaine peut atteindre cet objectif.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-156">The obvious absence of a grounding effect in this area may achieve this purpose.</span></span>

### <a name="occlusion"></a><span data-ttu-id="ee6b2-157">Occlusion</span><span class="sxs-lookup"><span data-stu-id="ee6b2-157">Occlusion</span></span>

<span data-ttu-id="ee6b2-158">L’une des principales utilisations des surfaces de mappage spatiales est simplement de occultait hologrammes.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-158">One of the primary uses of spatial mapping surfaces is simply to occlude holograms.</span></span> <span data-ttu-id="ee6b2-159">Ce comportement simple a un impact énorme sur le réalisme perçu des hologrammes, ce qui permet de créer un sens de Visceral qui occupe vraiment le même espace physique que l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-159">This simple behavior has a huge impact on the perceived realism of holograms, helping to create a visceral sense that really inhabit the same physical space as the user.</span></span>

<span data-ttu-id="ee6b2-160">L’occlusion fournit également des informations à l’utilisateur. Lorsqu’un hologramme semble être bloqués par une surface réaliste, cela fournit des commentaires visuels supplémentaires sur l’emplacement spatial de cet hologramme dans le monde.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-160">Occlusion also provides information to the user; when a hologram appears to be occluded by a real-world surface, this provides additional visual feedback as to the spatial location of that hologram in the world.</span></span> <span data-ttu-id="ee6b2-161">À l’inverse, l’occlusion peut également *Masquer* de façon utile les informations de l’utilisateur; l’occlusion des hologrammes derrière les murs peut réduire l’encombrement visuel de façon intuitive.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-161">Conversely, occlusion can also usefully *hide* information from the user; occluding holograms behind walls can reduce visual clutter in an intuitive way.</span></span> <span data-ttu-id="ee6b2-162">Pour masquer ou afficher un hologramme, l’utilisateur doit simplement déplacer son chef.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-162">To hide or reveal a hologram, the user merely has to move their head.</span></span>

<span data-ttu-id="ee6b2-163">L’occlusion peut également être utilisée pour répondre aux attentes d’une interface utilisateur naturelle basée sur des interactions physiques familières; Si un hologramme est bloqués par une surface, c’est parce que cette surface est pleine, de sorte que l’utilisateur doit s’attendre à ce que l’hologramme entre en *conflit* avec cette surface et non simplement le traverser.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-163">Occlusion can also be used to prime expectations for a natural user interface based upon familiar physical interactions; if a hologram is occluded by a surface it is because that surface is solid, so the user should expect that the hologram will *collide* with that surface and not simply pass through it.</span></span>

<span data-ttu-id="ee6b2-164">Parfois, l’occlusion des hologrammes n’est pas souhaitable.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-164">Sometimes, occlusion of holograms is undesirable.</span></span> <span data-ttu-id="ee6b2-165">Si un utilisateur doit être en mesure d’interagir avec un hologramme, il doit être en mesure de le voir, même s’il se trouve derrière une surface réaliste.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-165">If a user needs to be able to interact with a hologram, then they need to be able to see it - even if it is behind a real-world surface.</span></span> <span data-ttu-id="ee6b2-166">Dans ce cas, il est généralement judicieux d’afficher un tel hologramme différemment lorsqu’il est bloqués (par exemple, en réduisant sa luminosité).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-166">In such cases, it usually makes sense to render such a hologram differently when it is occluded (for example, by reducing its brightness).</span></span> <span data-ttu-id="ee6b2-167">De cette façon, l’utilisateur est en mesure de localiser visuellement l’hologramme, mais il est toujours conscient qu’il se trouve derrière un point.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-167">This way, the user will be able to visually locate the hologram, but they will still be aware that it is behind something.</span></span>

### <a name="physics"></a><span data-ttu-id="ee6b2-168">Physique</span><span class="sxs-lookup"><span data-stu-id="ee6b2-168">Physics</span></span>

<span data-ttu-id="ee6b2-169">L’utilisation de la simulation physique est une autre façon d’utiliser le mappage spatial pour renforcer la *présence* d’hologrammes dans l’espace physique de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-169">The use of physics simulation is another way in which spatial mapping can be used to reinforce the *presence* of holograms in the user's physical space.</span></span> <span data-ttu-id="ee6b2-170">Lorsque ma boule de caoutchouc holographique s’arrête de façon réaliste sur mon bureau, rebondit sur le sol et disparaît sous le canapé, il peut être difficile de croire qu’elle n’est pas vraiment là.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-170">When my holographic rubber ball rolls realistically off my desk, bounces across the floor and disappears under the couch, it might be hard for me to believe that it's not really there.</span></span>

<span data-ttu-id="ee6b2-171">La simulation physique offre également la possibilité pour une application d’utiliser des interactions naturelles et familières basées sur la physique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-171">Physics simulation also provides the opportunity for an application to use natural and familiar physics-based interactions.</span></span> <span data-ttu-id="ee6b2-172">Le déplacement d’un morceau de mobilier holographique sur le plancher sera probablement plus facile pour l’utilisateur si le meuble répond comme s’il avait été déplacé sur le sol avec l’inertie et la friction appropriées.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-172">Moving a piece of holographic furniture around on the floor will likely be easier for the user if the furniture responds as if it were sliding across the floor with the appropriate inertia and friction.</span></span>

<span data-ttu-id="ee6b2-173">Pour générer des comportements physiques réalistes, vous devrez probablement effectuer un [traitement par maillage](spatial-mapping.md#mesh-processing) , tel que le remplissage des trous, la suppression des hallucinations flottants et le lissage des surfaces approximatives.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-173">In order to generate realistic physical behaviors, you will likely need to perform some [mesh processing](spatial-mapping.md#mesh-processing) such as filling holes, removing floating hallucinations and smoothing rough surfaces.</span></span>

<span data-ttu-id="ee6b2-174">Vous devrez également réfléchir à la façon dont l' [expérience d’analyse](spatial-mapping-design.md#the-environment-scanning-experience) de votre application influence sa simulation physique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-174">You will also need to consider how your application's [scanning experience](spatial-mapping-design.md#the-environment-scanning-experience) influences its physics simulation.</span></span> <span data-ttu-id="ee6b2-175">Tout d’abord, les surfaces manquantes ne sont pas en conflit avec quoi que ce soit; que se passe-t-il lorsque la balle en caoutchouc s’arrête au couloir et à la fin du monde connu?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-175">Firstly, missing surfaces won't collide with anything; what happens when the rubber ball rolls off down the corridor and off the end of the known world?</span></span> <span data-ttu-id="ee6b2-176">Deuxièmement, vous devez décider si vous souhaitez continuer à répondre aux modifications de l’environnement dans le temps.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-176">Secondly, you need to decide whether you will continue to respond to changes in the environment over time.</span></span> <span data-ttu-id="ee6b2-177">Dans certains cas, vous souhaiterez peut-être répondre le plus rapidement possible. Imaginons que l’utilisateur utilise des portes et des meubles comme barricadesables dans la défense contre un TEMPEST de flèches latines entrantes.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-177">In some cases, you will want to respond as quickly as possible; say if the user is using doors and furniture as movable barricades in defense against a tempest of incoming Roman arrows.</span></span> <span data-ttu-id="ee6b2-178">Dans d’autres cas, vous souhaiterez peut-être ignorer les nouvelles mises à jour; la conduite de votre voiture de sport holographique autour de la Racetrack à votre étage peut ne pas être si amusante si votre chien décide de se asseoir au milieu de la piste.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-178">In other cases though, you may want to ignore new updates; driving your holographic sports car around the racetrack on your floor may suddenly not be so fun if your dog decides to sit in the middle of the track.</span></span>

### <a name="navigation"></a><span data-ttu-id="ee6b2-179">Navigation</span><span class="sxs-lookup"><span data-stu-id="ee6b2-179">Navigation</span></span>

<span data-ttu-id="ee6b2-180">Les applications peuvent utiliser des données de mappage spatiale pour accorder aux caractères holographiques (ou agents) la possibilité de naviguer dans le monde réel de la même manière qu’une personne réelle.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-180">Applications can use spatial mapping data to grant holographic characters (or agents) the ability to navigate the real world in the same way a real person would.</span></span> <span data-ttu-id="ee6b2-181">Cela peut aider à renforcer la présence de caractères holographiques en les limitant au même ensemble de comportements naturels et familiers que ceux de l’utilisateur et de leurs amis.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-181">This can help reinforce the presence of holographic characters by restricting them to the same set of natural, familiar behaviors as those of the user and their friends.</span></span>

<span data-ttu-id="ee6b2-182">Les fonctionnalités de navigation peuvent également être utiles aux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-182">Navigation capabilities could be useful to users as well.</span></span> <span data-ttu-id="ee6b2-183">Une fois qu’une carte de navigation a été créée dans une zone donnée, elle peut être partagée pour fournir des directions holographiques pour les nouveaux utilisateurs qui ne sont pas familiarisés avec cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-183">Once a navigation map has been built in a given area, it could be shared to provide holographic directions for new users unfamiliar with that location.</span></span> <span data-ttu-id="ee6b2-184">Cette carte peut être conçue pour garantir le bon déroulement du trafic «piéton», ou pour éviter les accidents dans des lieux dangereux tels que des sites de construction.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-184">This map could be designed to help keep pedestrian 'traffic' flowing smoothly, or to avoid accidents in dangerous locations like construction sites.</span></span>

<span data-ttu-id="ee6b2-185">Les principaux défis techniques liés à la mise en œuvre de la fonctionnalité de navigation sont la détection fiable des surfaces guidées (les êtres humains ne se déplacent pas sur les tables!) et l’adaptation progressive aux changements de l’environnement (les êtres humains ne parcourent pas les portes fermées!).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-185">The key technical challenges involved in implementing navigation functionality will be reliable detection of walkable surfaces (humans don't walk on tables!) and graceful adaptation to changes in the environment (humans don't walk through closed doors!).</span></span> <span data-ttu-id="ee6b2-186">La maille peut nécessiter un [traitement](spatial-mapping.md#mesh-processing) avant de pouvoir être utilisée pour la planification des chemins d’accès et la navigation par un caractère virtuel.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-186">The mesh may require some [processing](spatial-mapping.md#mesh-processing) before it is usable for path-planning and navigation by a virtual character.</span></span> <span data-ttu-id="ee6b2-187">Le lissage de la maille et la suppression des hallucinations peuvent aider à éviter que des caractères soient bloqués.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-187">Smoothing the mesh and removing hallucinations may help avoid characters becoming stuck.</span></span> <span data-ttu-id="ee6b2-188">Vous pouvez également souhaiter simplifier considérablement la maille afin d’accélérer les calculs de la planification et de la navigation de vos caractères.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-188">You may also wish to drastically simplify the mesh in order to speed up your character's path-planning and navigation calculations.</span></span> <span data-ttu-id="ee6b2-189">Ces défis ont bien fait l’affaire d’une grande attention dans le développement de la technologie Videogame et il existe une multitude de documents de recherche disponibles sur ces sujets.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-189">These challenges have received a great deal of attention in the development of videogame technology, and there is a wealth of available research literature on these topics.</span></span>

<span data-ttu-id="ee6b2-190">Notez que la fonctionnalité intégrée NavMesh dans Unity ne peut pas être utilisée avec des surfaces de mappage spatiale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-190">Note that the built-in NavMesh functionality in Unity cannot be used with spatial mapping surfaces.</span></span> <span data-ttu-id="ee6b2-191">En effet, les surfaces de mappage spatiale ne sont pas connues jusqu’au démarrage de l’application, tandis que les fichiers de données NavMesh doivent être générés à partir des ressources sources à l’avance.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-191">This is because spatial mapping surfaces are not known until the application starts, whereas NavMesh data files need to be generated from source assets ahead of time.</span></span> <span data-ttu-id="ee6b2-192">Notez également que le système de mappage spatial ne fournit pas d' [informations sur les surfaces très loin](spatial-mapping-design.md#the-environment-scanning-experience) de l’emplacement actuel de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-192">Also note that, the spatial mapping system will not provide [information about surfaces very far away](spatial-mapping-design.md#the-environment-scanning-experience) from the user's current location.</span></span> <span data-ttu-id="ee6b2-193">Par conséquent, l’application doit se déconnecter de lui-même s’il s’agit de créer une carte d’une très grande zone.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-193">So the application must 'remember' surfaces itself if it is to build a map of a very large area.</span></span>

### <a name="visualization"></a><span data-ttu-id="ee6b2-194">Sessions</span><span class="sxs-lookup"><span data-stu-id="ee6b2-194">Visualization</span></span>

<span data-ttu-id="ee6b2-195">La plupart du temps, il convient que les surfaces spatiales soient invisibles; pour réduire l’encombrement visuel et laisser le monde réel parler de lui-même.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-195">Most of the time it is appropriate for spatial surfaces to be invisible; to minimize visual clutter and let the real world speak for itself.</span></span> <span data-ttu-id="ee6b2-196">Toutefois, il est parfois utile de visualiser les surfaces de mappage spatiales directement, malgré le fait que leurs équivalents réels sont déjà visibles.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-196">However, sometimes it is useful to visualize spatial mapping surfaces directly, despite the fact that their real-world counterparts are already visible.</span></span>

<span data-ttu-id="ee6b2-197">Par exemple, lorsque l’utilisateur tente de placer un hologramme sur une surface (en plaçant une armoire holographique sur le mur, par exemple), il peut être utile d’utiliser l’hologramme en convertissant une ombre sur l’aire.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-197">For example, when the user is trying to place a hologram onto a surface (placing a holographic cabinet on the wall, say) it can be useful to 'ground' the hologram by casting a shadow onto the surface.</span></span> <span data-ttu-id="ee6b2-198">Cela donne à l’utilisateur un sens nettement plus clair de la proximité physique exacte entre l’hologramme et la surface.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-198">This gives the user a much clearer sense of the exact physical proximity between the hologram and the surface.</span></span> <span data-ttu-id="ee6b2-199">Il s’agit également d’un exemple de la pratique plus générale de l’aperçu visuel d’une modification avant que l’utilisateur ne la valide.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-199">This is also an example of the more general practice of visually 'previewing' a change before the user commits to it.</span></span>

<span data-ttu-id="ee6b2-200">Grâce à la visualisation des surfaces, l’application peut partager avec l’utilisateur sa compréhension de l’environnement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-200">By visualizing surfaces, the application can share with the user its understanding of the environment.</span></span> <span data-ttu-id="ee6b2-201">Par exemple, un jeu de cartes holographiques peut visualiser les surfaces horizontales qu’il a identifiées comme «tables», afin que l’utilisateur sache où il doit accéder à l’interaction.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-201">For example, a holographic board game could visualize the horizontal surfaces that it has identified as 'tables', so the user knows where they should go to interact.</span></span>

<span data-ttu-id="ee6b2-202">La visualisation des surfaces peut être un moyen utile pour montrer à l’utilisateur des espaces qui sont masqués dans l’affichage.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-202">Visualizing surfaces can be a useful way to show the user nearby spaces that are hidden from view.</span></span> <span data-ttu-id="ee6b2-203">Cela peut fournir un moyen simple de donner à l’utilisateur l’accès à sa cuisine (et à tous ses hologrammes contenus) à partir de son salon.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-203">This could provide a simple way to give the user access to their kitchen (and all of its contained holograms) from their living room.</span></span>

<span data-ttu-id="ee6b2-204">Les maillages de surface fournis par le mappage spatial peuvent ne pas être particulièrement «nettoyés».</span><span class="sxs-lookup"><span data-stu-id="ee6b2-204">The surface meshes provided by spatial mapping may not be particularly 'clean'.</span></span> <span data-ttu-id="ee6b2-205">Il est donc important de les visualiser de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-205">Thus it is important to visualize them appropriately.</span></span> <span data-ttu-id="ee6b2-206">Les calculs d’éclairage traditionnels peuvent mettre en évidence les erreurs dans les normales de surface de manière visuellement gênante, tandis que les textures «propres» projetées sur l’aire peuvent aider à lui attribuer une apparence de plus propre.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-206">Traditional lighting calculations may highlight errors in surface normals in a visually distracting manner, whilst 'clean' textures projected onto the surface may help to give it a tidier appearance.</span></span> <span data-ttu-id="ee6b2-207">Il est également possible d’effectuer un [traitement de maillage](spatial-mapping.md#mesh-processing) pour améliorer les propriétés de maillage, avant le rendu des surfaces.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-207">It is also possible to perform [mesh processing](spatial-mapping.md#mesh-processing) to improve mesh properties, before the surfaces are rendered.</span></span>

## <a name="using-the-surface-observer"></a><span data-ttu-id="ee6b2-208">Utilisation de l’observateur de surface</span><span class="sxs-lookup"><span data-stu-id="ee6b2-208">Using The Surface Observer</span></span>

<span data-ttu-id="ee6b2-209">Le point de départ pour le mappage spatial est l’observateur de surface.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-209">The starting point for spatial mapping is the surface observer.</span></span> <span data-ttu-id="ee6b2-210">Le déroulement du programme est le suivant:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-210">Program flow is as follows:</span></span>
* <span data-ttu-id="ee6b2-211">Créer un objet d’observateur de surface</span><span class="sxs-lookup"><span data-stu-id="ee6b2-211">Create a surface observer object</span></span>
   * <span data-ttu-id="ee6b2-212">Fournissez un ou plusieurs volumes spatiaux pour définir les régions d’intérêt pour lesquelles l’application souhaite recevoir des données de mappage spatiale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-212">Provide one or more spatial volumes, to define the regions of interest in which the application wishes to receive spatial mapping data.</span></span> <span data-ttu-id="ee6b2-213">Un volume spatial est simplement une forme définissant une zone d’espace, telle qu’une sphère ou une zone.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-213">A spatial volume is simply a shape defining a region of space, such as a sphere or a box.</span></span>
   * <span data-ttu-id="ee6b2-214">Utilisez un volume spatial avec un système de coordonnées spatiales verrouillé pour identifier une région fixe du monde physique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-214">Use a spatial volume with a world-locked spatial coordinate system to identify a fixed region of the physical world.</span></span>
   * <span data-ttu-id="ee6b2-215">Utilisez un volume spatial, mettez à jour chaque cadre avec un système de coordonnées spatiales verrouillées pour identifier une région d’espace qui se déplace (mais ne pivote pas) avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-215">Use a spatial volume, updated each frame with a body-locked spatial coordinate system, to identify a region of space that moves (but does not rotate) with the user.</span></span>
   * <span data-ttu-id="ee6b2-216">Ces volumes spatiaux peuvent être modifiés ultérieurement à tout moment, à mesure que l’état de l’application ou de l’utilisateur change.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-216">These spatial volumes may be changed later at any time, as the status of the application or the user changes.</span></span>
* <span data-ttu-id="ee6b2-217">Utiliser l’interrogation ou la notification pour extraire des informations sur les surfaces spatiales</span><span class="sxs-lookup"><span data-stu-id="ee6b2-217">Use polling or notification to retrieve information about spatial surfaces</span></span>
   * <span data-ttu-id="ee6b2-218">Vous pouvez interroger l’observateur de surface pour l’état de surface spatiale à tout moment.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-218">You may 'poll' the surface observer for spatial surface status at any time.</span></span> <span data-ttu-id="ee6b2-219">Vous pouvez également vous inscrire à l’événement «surfaces modifiées» de l’observateur de surface, qui notifie l’application quand des surfaces spatiales ont changé.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-219">Alternatively, you may register for the surface observer's 'surfaces changed' event, which will notify the application when spatial surfaces have changed.</span></span>
   * <span data-ttu-id="ee6b2-220">Pour un volume spatial dynamique, tel que la vue frustum, ou un volume verrouillé par le corps, les applications doivent interroger les modifications de chaque image en définissant la région d’intérêt, puis en obtenant l’ensemble actuel de surfaces spatiales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-220">For a dynamic spatial volume, such as the view frustum, or a body-locked volume, applications will need to poll for changes each frame by setting the region of interest and then obtaining the current set of spatial surfaces.</span></span>
   * <span data-ttu-id="ee6b2-221">Pour un volume statique, tel qu’un cube verrouillé couvrant une seule pièce, les applications peuvent s’inscrire à l’événement «surfaces modifiées» pour être averti lorsque des surfaces spatiales à l’intérieur de ce volume peuvent avoir changé.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-221">For a static volume, such as a world-locked cube covering a single room, applications may register for the 'surfaces changed' event to be notified when spatial surfaces inside that volume may have changed.</span></span>
* <span data-ttu-id="ee6b2-222">Modifications des surfaces de processus</span><span class="sxs-lookup"><span data-stu-id="ee6b2-222">Process surfaces changes</span></span>
   * <span data-ttu-id="ee6b2-223">Itérez l’ensemble de surfaces spatiales fourni.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-223">Iterate the provided set of spatial surfaces.</span></span>
   * <span data-ttu-id="ee6b2-224">Classer les surfaces spatiales comme ajoutées, modifiées ou supprimées.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-224">Classify spatial surfaces as added, changed or removed.</span></span>
   * <span data-ttu-id="ee6b2-225">Pour chaque surface spatiale ajoutée ou modifiée, si nécessaire, envoyez une demande asynchrone pour recevoir la maille mise à jour représentant l’état actuel de la surface au niveau de détail souhaité.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-225">For each added or changed spatial surface, if appropriate submit an asynchronous request to receive updated mesh representing the surface's current state at the desired level of detail.</span></span>
* <span data-ttu-id="ee6b2-226">Traiter la requête de maillage asynchrone (plus de détails dans les sections suivantes).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-226">Process the asynchronous mesh request (more details in following sections).</span></span>

## <a name="mesh-caching"></a><span data-ttu-id="ee6b2-227">Mise en cache de maillage</span><span class="sxs-lookup"><span data-stu-id="ee6b2-227">Mesh Caching</span></span>

<span data-ttu-id="ee6b2-228">Les surfaces spatiales sont représentées par des maillages à angle dense.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-228">Spatial surfaces are represented by dense triangle meshes.</span></span> <span data-ttu-id="ee6b2-229">Le stockage, le rendu et le traitement de ces mailles peuvent consommer des ressources de calcul et de stockage significatives.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-229">Storing, rendering and processing these meshes can consume significant computational and storage resources.</span></span> <span data-ttu-id="ee6b2-230">Par conséquent, chaque application doit adopter un schéma de mise en cache de maillage adapté à ses besoins, afin de réduire les ressources utilisées pour le traitement et le stockage du maillage.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-230">As such, each application should adopt a mesh caching scheme appropriate to its needs, in order to minimize the resources used for mesh processing and storage.</span></span> <span data-ttu-id="ee6b2-231">Ce schéma doit déterminer les maillages à conserver et les à ignorer, ainsi que la mise à jour de la maille pour chaque surface spatiale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-231">This scheme should determine which meshes to retain and which to discard, as well as when to update the mesh for each spatial surface.</span></span>

<span data-ttu-id="ee6b2-232">La plupart des considérations abordées expliquent directement comment votre application doit utiliser la mise en cache de maille.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-232">Many of the considerations discussed there will directly inform how your application should approach mesh caching.</span></span> <span data-ttu-id="ee6b2-233">Vous devez réfléchir à la façon dont l’utilisateur se déplace dans l’environnement, quelles sont les surfaces nécessaires, lorsque différentes surfaces sont observées et lorsque les modifications de l’environnement doivent être capturées.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-233">You should consider how the user moves through the environment, which surfaces are needed, when different surfaces will be observed and when changes in the environment should be captured.</span></span>

<span data-ttu-id="ee6b2-234">Lors de l’interprétation de l’événement «surfaces modifiées» fourni par l’observateur de surface, la logique de mise en cache du maillage de base est la suivante:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-234">When interpreting the 'surfaces changed' event provided by the surface observer, the basic mesh caching logic is as follows:</span></span>
* <span data-ttu-id="ee6b2-235">Si l’application voit un ID de surface spatiale qu’elle n’a pas déjà vu, elle doit la traiter en tant que nouvelle surface spatiale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-235">If the application sees a spatial surface ID that it has not seen before, it should treat this as a new spatial surface.</span></span>
* <span data-ttu-id="ee6b2-236">Si l’application voit une surface spatiale avec un ID connu mais avec une nouvelle heure de mise à jour, elle doit considérer cela comme une surface spatiale mise à jour.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-236">If the application sees a spatial surface with a known ID but with a new update time, it should treat this as an updated spatial surface.</span></span>
* <span data-ttu-id="ee6b2-237">Si l’application ne voit plus une surface spatiale avec un ID connu, elle doit la traiter comme une surface spatiale supprimée.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-237">If the application no longer sees a spatial surface with a known ID, it should treat this as a removed spatial surface.</span></span>

<span data-ttu-id="ee6b2-238">Chaque application peut ensuite effectuer les choix suivants:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-238">It is up to each application to then make the following choices:</span></span>
* <span data-ttu-id="ee6b2-239">Pour les nouvelles surfaces spatiales, le maillage doit-il être demandé?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-239">For new spatial surfaces, should mesh be requested?</span></span>
   * <span data-ttu-id="ee6b2-240">En général, la maille doit être demandée immédiatement pour les nouvelles surfaces spatiales, ce qui peut fournir de nouvelles informations utiles à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-240">Generally mesh should be requested immediately for new spatial surfaces, which may provide useful new information to the user.</span></span>
   * <span data-ttu-id="ee6b2-241">Toutefois, les nouvelles surfaces spatiales près et avant de l’utilisateur doivent être prioritaires et leur maillage doit être demandé en premier.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-241">However, new spatial surfaces near and in front of the user should be given priority and their mesh should be requested first.</span></span>
   * <span data-ttu-id="ee6b2-242">Si le nouveau maillage n’est pas nécessaire, si, par exemple, l’application a, de manière permanente ou provisoire, son modèle d’environnement, elle ne doit pas être demandée.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-242">If the new mesh is not needed, if for example the application has permanently or temporarily 'frozen' its model of the environment, then it should not be requested.</span></span>
* <span data-ttu-id="ee6b2-243">Pour les surfaces spatiales mises à jour, le maillage doit-il être demandé?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-243">For updated spatial surfaces, should mesh be requested?</span></span>
   * <span data-ttu-id="ee6b2-244">Les surfaces spatiales mises à jour à proximité et devant l’utilisateur doivent être prioritaires et leur maillage doit être demandé en premier.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-244">Updated spatial surfaces near and in front of the user should be given priority and their mesh should be requested first.</span></span>
   * <span data-ttu-id="ee6b2-245">Il peut également être utile d’attribuer aux nouvelles surfaces une priorité plus élevée que celle des surfaces mises à jour, en particulier lors de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-245">It may also be appropriate to give higher priority to new surfaces than to updated surfaces, especially during the scanning experience.</span></span>
   * <span data-ttu-id="ee6b2-246">Pour limiter les coûts de traitement, les applications peuvent souhaiter limiter la vitesse à laquelle elles traitent les mises à jour des surfaces spatiales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-246">To limit processing costs, applications may wish to throttle the rate at which they process updates to spatial surfaces.</span></span>
   * <span data-ttu-id="ee6b2-247">Il peut être possible de déduire que les modifications apportées à une surface spatiale sont mineures, par exemple si les limites de la surface sont petites, auquel cas la mise à jour peut ne pas être suffisamment importante pour le traitement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-247">It may be possible to infer that changes to a spatial surface are minor, for example if the bounds of the surface are small, in which case the update may not be important enough to process.</span></span>
   * <span data-ttu-id="ee6b2-248">Les mises à jour apportées aux surfaces spatiales en dehors de la région actuelle de l’utilisateur peuvent être ignorées entièrement, mais dans ce cas, il peut être plus efficace de modifier les volumes de limite spatiale en cours d’utilisation par l’observateur de surface.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-248">Updates to spatial surfaces outside the current region of interest of the user may be ignored entirely, though in this case it may be more efficient to modify the spatial bounding volumes in use by the surface observer.</span></span>
* <span data-ttu-id="ee6b2-249">Pour les surfaces spatiales supprimées, le maillage doit-il être abandonné?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-249">For removed spatial surfaces, should mesh be discarded?</span></span>
   * <span data-ttu-id="ee6b2-250">Généralement, la maille doit être ignorée immédiatement pour les surfaces spatiales supprimées, afin que l’occlusion d’hologramme reste correcte.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-250">Generally mesh should be discarded immediately for removed spatial surfaces, so that hologram occlusion remains correct.</span></span>
   * <span data-ttu-id="ee6b2-251">Toutefois, si l’application a du mal à penser qu’une surface spatiale réapparaîtra bientôt (peut-être en raison de la conception de l’expérience utilisateur), il peut être plus efficace de la conserver que d’ignorer son maillage et de la recréer ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-251">However, if the application has reason to believe that a spatial surface will reappear shortly (perhaps based upon the design of the user experience), then it may be more efficient to retain it than to discard its mesh and recreate it again later.</span></span>
   * <span data-ttu-id="ee6b2-252">Si l’application crée un modèle à grande échelle de l’environnement de l’utilisateur, il se peut qu’elle ne souhaite pas supprimer les mailles.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-252">If the application is building a large-scale model of the user's environment then it may not wish to discard any meshes at all.</span></span> <span data-ttu-id="ee6b2-253">Toutefois, il est nécessaire de limiter l’utilisation des ressources, éventuellement en spoulés les maillages sur le disque en tant que surfaces spatiales disparaissent.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-253">It will still need to limit resource usage though, possibly by spooling meshes to disk as spatial surfaces disappear.</span></span>
   * <span data-ttu-id="ee6b2-254">Notez que certains événements relativement rares pendant la génération de la surface spatiale peuvent entraîner le remplacement des surfaces spatiales par de nouvelles surfaces spatiales dans un emplacement similaire, mais avec des ID différents.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-254">Note that some relatively rare events during spatial surface generation can cause spatial surfaces to be replaced by new spatial surfaces in a similar location but with different IDs.</span></span> <span data-ttu-id="ee6b2-255">Par conséquent, les applications qui choisissent de ne pas ignorer une surface supprimée doivent veiller à ne pas se retrouver avec plusieurs maillages de surface spatiales très superposés couvrant le même emplacement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-255">Consequently, applications that choose not to discard a removed surface should take care not to end up with multiple highly-overlapped spatial surface meshes covering the same location.</span></span>
* <span data-ttu-id="ee6b2-256">Le maillage doit-il être ignoré pour toutes les autres surfaces spatiales?</span><span class="sxs-lookup"><span data-stu-id="ee6b2-256">Should mesh be discarded for any other spatial surfaces?</span></span>
   * <span data-ttu-id="ee6b2-257">Même s’il existe une surface spatiale, si elle n’est plus utile à l’expérience de l’utilisateur, elle doit être ignorée.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-257">Even while a spatial surface exists, if it is no longer useful to the user's experience then it should be discarded.</span></span> <span data-ttu-id="ee6b2-258">Par exemple, si l’application «remplace» la salle de l’autre côté d’une porte avec un espace virtuel alternatif, les surfaces spatiales de cette salle n’ont plus d’importance.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-258">For example, if the application 'replaces' the room on the other side of a doorway with an alternate virtual space then the spatial surfaces in that room no longer matter.</span></span>

<span data-ttu-id="ee6b2-259">Voici un exemple de stratégie de mise en cache de maillage, utilisant des hystérésis spatiales et temporelles:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-259">Here is an example mesh caching strategy, using spatial and temporal hysteresis:</span></span>
* <span data-ttu-id="ee6b2-260">Prenons l’exemple d’une application qui souhaite utiliser un volume spatial d’intérêt en forme de frustum qui suit le regard de l’utilisateur à mesure qu’ils regardent et détaillent.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-260">Consider an application that wishes to use a frustum-shaped spatial volume of interest that follows the user's gaze as they look around and walk around.</span></span>
* <span data-ttu-id="ee6b2-261">Une surface spatiale peut disparaître temporairement sur ce volume simplement parce que l’utilisateur regarde à l’extérieur de la surface ou des étapes... seulement pour revenir en arrière ou se déplacer à nouveau un instant plus tard.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-261">A spatial surface may disappear temporarily from this volume simply because the user looks away from the surface or steps further away from it... only to look back or moves closer again a moment later.</span></span> <span data-ttu-id="ee6b2-262">Dans ce cas, l’abandon et la recréation du maillage pour cette surface représentent un traitement redondant important.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-262">In this case, discarding and re-creating the mesh for this surface represents a lot of redundant processing.</span></span>
* <span data-ttu-id="ee6b2-263">Pour réduire le nombre de modifications traitées, l’application utilise deux observateurs de surface spatiale, l’un contenu dans l’autre.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-263">To reduce the number of changes processed, the application uses two spatial surface observers, one contained within the other.</span></span> <span data-ttu-id="ee6b2-264">Le plus grand volume est sphérique et suit l’utilisateur «paresseuse». Il se déplace uniquement lorsque cela est nécessaire pour s’assurer que son centre se trouve dans 2,0 mètres de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-264">The larger volume is spherical and follows the user 'lazily'; it only moves when necessary to ensure that its centre is within 2.0 metres of the user.</span></span>
* <span data-ttu-id="ee6b2-265">Les maillages de surface spatiale nouveaux et mis à jour sont toujours traités à partir de l’observateur de surface interne plus petite, mais les maillages sont mis en cache jusqu’à ce qu’ils disparaissent de l’observateur de surface externe plus large.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-265">New and updated spatial surface meshes are always processed from the smaller inner surface observer, but meshes are cached until they disappear from the larger outer surface observer.</span></span> <span data-ttu-id="ee6b2-266">Cela permet à l’application d’éviter le traitement de nombreuses modifications redondantes en raison du déplacement de l’utilisateur local.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-266">This allows the application to avoid processing many redundant changes due to local user movement.</span></span>
* <span data-ttu-id="ee6b2-267">Comme une surface spatiale peut également disparaître temporairement en raison de la perte de suivi, l’application diffère également l’abandon des surfaces spatiales supprimées pendant le suivi de la perte.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-267">Since a spatial surface may also disappear temporarily due to tracking loss, the application also defers discarding removed spatial surfaces during tracking loss.</span></span>
* <span data-ttu-id="ee6b2-268">En général, une application doit évaluer le compromis entre le traitement des mises à jour réduites et l’augmentation de l’utilisation de la mémoire pour déterminer sa stratégie de mise en cache idéale.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-268">In general, an application should evaluate the tradeoff between reduced update processing and increased memory usage to determine its ideal caching strategy.</span></span>

## <a name="rendering"></a><span data-ttu-id="ee6b2-269">Rendu</span><span class="sxs-lookup"><span data-stu-id="ee6b2-269">Rendering</span></span>

<span data-ttu-id="ee6b2-270">Il existe trois façons principales pour lesquelles les maillages de mappage spatial ont tendance à être utilisés pour le rendu:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-270">There are three primary ways in which spatial mapping meshes tend to be used for rendering:</span></span>
* <span data-ttu-id="ee6b2-271">Pour la visualisation des surfaces</span><span class="sxs-lookup"><span data-stu-id="ee6b2-271">For surface visualization</span></span>
   * <span data-ttu-id="ee6b2-272">Il est souvent utile de visualiser directement les surfaces spatiales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-272">It is often useful to visualize spatial surfaces directly.</span></span> <span data-ttu-id="ee6b2-273">Par exemple, le cast de «Shadows» d’objets en surfaces spatiales peut fournir des commentaires visuels utiles à l’utilisateur pendant qu’ils placent des hologrammes sur des surfaces.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-273">For example, casting 'shadows' from objects onto spatial surfaces can provide helpful visual feedback to the user while they are placing holograms on surfaces.</span></span>
   * <span data-ttu-id="ee6b2-274">Une chose à garder à l’esprit est que les maillages spatiaux sont différents du type de maille qu’un artiste 3D peut créer.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-274">One thing to bear in mind is that spatial meshes are different to the kind of meshes that a 3D artist might create.</span></span> <span data-ttu-id="ee6b2-275">La topologie triangulaire n’est pas aussi «propre» que la topologie créée par l’utilisateur, et la maille est sujette à de [nombreuses erreurs](spatial-mapping-design.md#what-influences-spatial-mapping-quality).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-275">The triangle topology will not be as 'clean' as human-created topology, and the mesh will suffer from [various errors](spatial-mapping-design.md#what-influences-spatial-mapping-quality).</span></span>
   * <span data-ttu-id="ee6b2-276">Pour créer un visuel agréable, vous pouvez effectuer un [traitement de maillage](spatial-mapping.md#mesh-processing), par exemple pour remplir des trous ou normaliser les normales de surface.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-276">In order to create a pleasing visual aesthetic, you may thus want to perform some [mesh processing](spatial-mapping.md#mesh-processing), for example to fill holes or smooth surface normals.</span></span> <span data-ttu-id="ee6b2-277">Vous pouvez également utiliser un nuanceur pour projeter des textures conçues pour les artistes sur votre maille au lieu de visualiser directement la topologie de maillage et les normales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-277">You may also wish to use a shader to project artist-designed textures onto your mesh instead of directly visualizing mesh topology and normals.</span></span>
* <span data-ttu-id="ee6b2-278">Pour boucher les hologrammes derrière des surfaces réelles</span><span class="sxs-lookup"><span data-stu-id="ee6b2-278">For occluding holograms behind real-world surfaces</span></span>
   * <span data-ttu-id="ee6b2-279">Les surfaces spatiales peuvent être rendues dans une passe de profondeur uniquement qui affecte uniquement la [mémoire tampon de profondeur](https://msdn.microsoft.com/library/windows/desktop/bb219616(v=vs.85).aspx) et n’affecte pas les cibles de rendu des couleurs.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-279">Spatial surfaces can be rendered in a depth-only pass which only affects the [depth buffer](https://msdn.microsoft.com/library/windows/desktop/bb219616(v=vs.85).aspx) and does not affect color render targets.</span></span>
   * <span data-ttu-id="ee6b2-280">Cela fait passer la mémoire tampon de profondeur aux hologrammes occultait par la suite sous-tendant des surfaces spatiales.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-280">This primes the depth buffer to occlude subsequently-rendered holograms behind spatial surfaces.</span></span> <span data-ttu-id="ee6b2-281">L’occlusion précise des hologrammes améliore le sens dans lequel les hologrammes se trouvent vraiment dans l’espace physique de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-281">Accurate occlusion of holograms enhances the sense that holograms really exist within the user's physical space.</span></span>
   * <span data-ttu-id="ee6b2-282">Pour activer le rendu de profondeur uniquement, mettez à jour votre état de fusion pour affecter à [RenderTargetWriteMask](https://msdn.microsoft.com/library/windows/desktop/hh404492(v=vs.85).aspx) la valeur zéro pour toutes les cibles de rendu des couleurs.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-282">To enable depth-only rendering, update your blend state to set the [RenderTargetWriteMask](https://msdn.microsoft.com/library/windows/desktop/hh404492(v=vs.85).aspx) to zero for all color render targets.</span></span>
* <span data-ttu-id="ee6b2-283">Pour modifier l’apparence des bloqués hologrammes par surfaces réelles</span><span class="sxs-lookup"><span data-stu-id="ee6b2-283">For modifying the appearance of holograms occluded by real-world surfaces</span></span>
   * <span data-ttu-id="ee6b2-284">Normalement, la géométrie rendue est masquée lorsqu’elle est bloqués.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-284">Normally rendered geometry is hidden when it is occluded.</span></span> <span data-ttu-id="ee6b2-285">Pour ce faire, définissez la fonction Depth dans votre [État Depth-stencil](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx) sur «inférieur ou égal à», ce qui entraîne la visibilité de la géométrie uniquement lorsque celle-ci est plus **proche** de l’appareil photo que toutes les géométries affichées précédemment.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-285">This is achieved by setting the depth function in your [depth-stencil state](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx) to "less than or equal", which causes geometry to be visible only where it is **closer** to the camera than all previously rendered geometry.</span></span>
   * <span data-ttu-id="ee6b2-286">Toutefois, il peut être utile de garder une certaine géométrie visible même quand elle est bloqués et de modifier son apparence lorsque bloqués est un moyen de fournir des commentaires visuels à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-286">However, it may be useful to keep certain geometry visible even when it is occluded, and to modify its appearance when occluded as a way of providing visual feedback to the user.</span></span> <span data-ttu-id="ee6b2-287">Par exemple, cela permet à l’application de montrer à l’utilisateur l’emplacement d’un objet tout en le rendant clair, derrière une surface réelle.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-287">For example, this allows the application to show the user the location of an object whilst making it clear that is behind a real-world surface.</span></span>
   * <span data-ttu-id="ee6b2-288">Pour ce faire, restituez la géométrie une seconde fois avec un nuanceur différent qui crée l’apparence «bloqués» souhaitée.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-288">To achieve this, render the geometry a second time with a different shader that creates the desired 'occluded' appearance.</span></span> <span data-ttu-id="ee6b2-289">Avant de restituer la géométrie pour la deuxième fois, apportez deux modifications à l’état de votre [gabarit de profondeur](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-289">Before rendering the geometry for the second time, make two changes to your [depth-stencil state](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx).</span></span> <span data-ttu-id="ee6b2-290">Tout d’abord, définissez la fonction Depth sur «supérieur ou égal à», de façon à ce que la géométrie ne soit visible qu’à partir de l’appareil photo, par rapport à toute la géométrie précédemment rendue.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-290">First, set the depth function to "greater than or equal" so that the geometry will be visible only where it is **further** from the camera than all previously rendered geometry.</span></span> <span data-ttu-id="ee6b2-291">Ensuite, définissez DepthWriteMask sur zéro, afin que la mémoire tampon de profondeur ne soit pas modifiée (le tampon de profondeur doit continuer à représenter la profondeur de la géométrie la **plus proche** de l’appareil photo).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-291">Second, set the DepthWriteMask to zero, so that the depth buffer will not be modified (the depth buffer should continue to represent the depth of the geometry **closest** to the camera).</span></span>

<span data-ttu-id="ee6b2-292">Les [performances](understanding-performance-for-mixed-reality.md) sont une préoccupation importante lors du rendu de maillages de mappages spatiaux.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-292">[Performance](understanding-performance-for-mixed-reality.md) is an important concern when rendering spatial mapping meshes.</span></span> <span data-ttu-id="ee6b2-293">Voici quelques techniques de performances de rendu spécifiques au rendu des maillages de mappage spatial:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-293">Here are some rendering performance techniques specific to rendering spatial mapping meshes:</span></span>
* <span data-ttu-id="ee6b2-294">Ajuster la densité du triangle</span><span class="sxs-lookup"><span data-stu-id="ee6b2-294">Adjust triangle density</span></span>
   * <span data-ttu-id="ee6b2-295">Lors de la demande de maillages de surfaces spatiales à partir de votre observateur de surface, demandez la densité la plus faible des maillages de triangle qui suffira à vos besoins.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-295">When requesting spatial surface meshes from your surface observer, request the lowest density of triangle meshes that will suffice for your needs.</span></span>
   * <span data-ttu-id="ee6b2-296">Il peut être judicieux de modifier la densité des triangles sur une surface par surface, en fonction de la distance de la surface de l’utilisateur et de sa pertinence pour l’expérience utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-296">It may make sense to vary triangle density on a surface by surface basis, depending on the surface's distance from the user, and its relevance to the user experience.</span></span>
   * <span data-ttu-id="ee6b2-297">La réduction du nombre de triangles réduira les coûts d’utilisation de la mémoire et de traitement des vertex sur le GPU, bien qu’il n’affecte pas les coûts de traitement des pixels.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-297">Reducing triangle counts will reduce memory usage and vertex processing costs on the GPU, though it will not affect pixel processing costs.</span></span>
* <span data-ttu-id="ee6b2-298">Effectuer une élimination frustum</span><span class="sxs-lookup"><span data-stu-id="ee6b2-298">Perform frustum culling</span></span>
   * <span data-ttu-id="ee6b2-299">L’élimination de frustum ignore les objets de dessin qui ne peuvent pas être vus, car ils se trouvent en dehors du frustum d’affichage actuel.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-299">Frustum culling skips drawing objects that cannot be seen because they are outside the current display frustum.</span></span> <span data-ttu-id="ee6b2-300">Cela réduit les coûts de traitement du processeur et du GPU.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-300">This reduces both CPU and GPU processing costs.</span></span>
   * <span data-ttu-id="ee6b2-301">Étant donné que l’élimination est effectuée au niveau de chaque maillage et que les surfaces spatiales peuvent être volumineuses, le fait de diviser chaque maillage de surface spatiale en plus petits blocs peut entraîner une élimination plus efficace (dans le cas où un nombre réduit de triangles hors écran sont rendus).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-301">Since culling is performed on a per-mesh basis and spatial surfaces can be large, breaking each spatial surface mesh into smaller chunks may result in more efficient culling (in that fewer offscreen triangles are rendered).</span></span> <span data-ttu-id="ee6b2-302">Toutefois, il existe un compromis. plus vous avez de maillages, plus les appels de dessin que vous devez effectuer, ce qui peut augmenter les coûts de l’UC.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-302">There is a tradeoff, however; the more meshes you have, the more draw calls you must make, which can increase CPU costs.</span></span> <span data-ttu-id="ee6b2-303">Dans un cas extrême, les calculs d’élimination des frustum peuvent même avoir un coût d’UC mesurable.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-303">In an extreme case, the frustum culling calculations themselves could even have a measurable CPU cost.</span></span>
* <span data-ttu-id="ee6b2-304">Ajuster l’ordre de rendu</span><span class="sxs-lookup"><span data-stu-id="ee6b2-304">Adjust rendering order</span></span>
   * <span data-ttu-id="ee6b2-305">Les surfaces spatiales ont tendance à être volumineuses, car elles représentent l’environnement entier de l’utilisateur qui les entoure.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-305">Spatial surfaces tend to be large, because they represent the user's entire environment surrounding them.</span></span> <span data-ttu-id="ee6b2-306">Les coûts de traitement des pixels sur le GPU peuvent donc être élevés, en particulier dans les cas où il y a plus d’une couche de géométrie visible (y compris des surfaces spatiales et d’autres hologrammes).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-306">Pixel processing costs on the GPU can thus be high, especially in cases where there is more than one layer of visible geometry (including both spatial surfaces and other holograms).</span></span> <span data-ttu-id="ee6b2-307">Dans ce cas, la couche la plus proche de l’utilisateur va abandonner toutes les couches, de sorte que tout temps GPU consacré au rendu de ces autres couches distantes est gaspillé.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-307">In this case, the layer nearest to the user will be occluding any layers further away, so any GPU time spent rendering those more distant layers is wasted.</span></span>
   * <span data-ttu-id="ee6b2-308">Pour réduire ce travail redondant sur le GPU, il est utile de restituer les surfaces opaques dans l’ordre avant-arrière (les plus proches en premier, les plus éloignées en dernier).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-308">To reduce this redundant work on the GPU, it helps to render opaque surfaces in front-to-back order (closer ones first, more distant ones last).</span></span> <span data-ttu-id="ee6b2-309">Par «opaque», nous entendons les surfaces pour lesquelles le DepthWriteMask est défini sur un dans l’état de votre [gabarit de profondeur](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-309">By 'opaque' we mean surfaces for which the DepthWriteMask is set to one in your [depth-stencil state](https://msdn.microsoft.com/library/windows/desktop/ff476110(v=vs.85).aspx).</span></span> <span data-ttu-id="ee6b2-310">Lorsque les surfaces les plus proches sont rendues, elles priment le tampon de profondeur afin que davantage de surfaces distantes soient correctement ignorées par le processeur de pixels sur le GPU.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-310">When the nearest surfaces are rendered, they will prime the depth buffer so that more distant surfaces are efficiently skipped by the pixel processor on the GPU.</span></span>

## <a name="mesh-processing"></a><span data-ttu-id="ee6b2-311">Traitement de maillage</span><span class="sxs-lookup"><span data-stu-id="ee6b2-311">Mesh Processing</span></span>

<span data-ttu-id="ee6b2-312">Une application peut souhaiter effectuer [diverses opérations](spatial-mapping.md#mesh-processing) sur les maillages de surface spatiale en fonction de ses besoins.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-312">An application may want to perform [various operations](spatial-mapping.md#mesh-processing) on spatial surface meshes to suit its needs.</span></span> <span data-ttu-id="ee6b2-313">Les données d’index et de vertex fournies avec chaque maillage de surface spatiale utilisent la même disposition familière que les [mémoires tampons de vertex et d’index](https://msdn.microsoft.com/library/windows/desktop/bb147325%28v=vs.85%29.aspx) utilisées pour le rendu des maillages de triangle dans toutes les API de rendu modernes.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-313">The index and vertex data provided with each spatial surface mesh uses the same familiar layout as the [vertex and index buffers](https://msdn.microsoft.com/library/windows/desktop/bb147325%28v=vs.85%29.aspx) that are used for rendering triangle meshes in all modern rendering APIs.</span></span> <span data-ttu-id="ee6b2-314">Toutefois, l’un des principaux faits à connaître est que les triangles de mappage spatial ont un **ordre de déroulement dans le sens inverse des aiguilles**d’une montre.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-314">However, one key fact to be aware of is that spatial mapping triangles have a **front-clockwise winding order**.</span></span> <span data-ttu-id="ee6b2-315">Chaque triangle est représenté par trois index de vertex dans le tampon d’index de la maille et ces index identifient les vertex du triangle dans le **sens des aiguilles** d’une montre, lorsque le triangle est affiché du côté **frontal** .</span><span class="sxs-lookup"><span data-stu-id="ee6b2-315">Each triangle is represented by three vertex indices in the mesh's index buffer and these indices will identify the triangle's vertices in a **clockwise** order, when the triangle is viewed from the **front** side.</span></span> <span data-ttu-id="ee6b2-316">Le côté avant (ou à l’extérieur) des maillages de surface spatiales correspond au côté de l’avant (visible) des surfaces universelles réelles.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-316">The front side (or outside) of spatial surface meshes corresponds as you would expect to the front (visible) side of real world surfaces.</span></span>

<span data-ttu-id="ee6b2-317">Les applications doivent uniquement effectuer une simplification de la maille si la densité de triangle la plus grossière fournie par l’observateur de surface est toujours insuffisante. ce travail est coûteux en termes de calcul et est déjà effectué par le runtime pour générer les différentes niveaux de détail fournis.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-317">Applications should only perform mesh simplification if the coarsest triangle density provided by the surface observer is still insufficiently coarse - this work is computationally expensive and already being performed by the runtime to generate the various provided levels of detail.</span></span>

<span data-ttu-id="ee6b2-318">Étant donné que chaque observateur de surface peut fournir plusieurs surfaces spatiales non connectées, certaines applications peuvent souhaiter découper ces maillages de surface spatiale entre eux, puis les éclairer ensemble.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-318">Because each surface observer can provide multiple unconnected spatial surfaces, some applications may wish to clip these spatial surface meshes against each other, then zipper them together.</span></span> <span data-ttu-id="ee6b2-319">En général, l’étape de découpage est nécessaire, car les maillages de surface spatiale avoisinants se chevauchent souvent légèrement.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-319">In general, the clipping step is required, as nearby spatial surface meshes often overlap slightly.</span></span>

## <a name="raycasting-and-collision"></a><span data-ttu-id="ee6b2-320">Raycasting et collision</span><span class="sxs-lookup"><span data-stu-id="ee6b2-320">Raycasting and Collision</span></span>

<span data-ttu-id="ee6b2-321">Pour qu’une API physique (telle que [Havok](http://www.havok.com/)) fournisse une application avec des fonctionnalités de Raycasting et de collision pour les surfaces spatiales, l’application doit fournir des maillages de surface spatiale à l’API physique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-321">In order for a physics API (such as [Havok](http://www.havok.com/)) to provide an application with raycasting and collision functionality for spatial surfaces, the application must provide spatial surface meshes to the physics API.</span></span> <span data-ttu-id="ee6b2-322">Les maillages utilisés pour la physique ont souvent les propriétés suivantes:</span><span class="sxs-lookup"><span data-stu-id="ee6b2-322">Meshes used for physics often have the following properties:</span></span>
* <span data-ttu-id="ee6b2-323">Ils ne contiennent qu’un petit nombre de triangles.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-323">They contain only small numbers of triangles.</span></span> <span data-ttu-id="ee6b2-324">Les opérations physiques sont plus gourmandes en calcul que les opérations de rendu.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-324">Physics operations are more computationally intensive than rendering operations.</span></span>
* <span data-ttu-id="ee6b2-325">Ils sont serrés.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-325">They are 'water-tight'.</span></span> <span data-ttu-id="ee6b2-326">Les surfaces destinées à être solides ne doivent pas avoir de petits trous; même les trous trop petits pour être visibles peuvent entraîner des problèmes.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-326">Surfaces intended to be solid should not have small holes in them; even holes too small to be visible can cause problems.</span></span>
* <span data-ttu-id="ee6b2-327">Ils sont convertis en coques convexes.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-327">They are converted into convex hulls.</span></span> <span data-ttu-id="ee6b2-328">Les coques convexes comportent peu de polygones et sont exemptes de trous, et elles sont beaucoup plus efficaces en termes de calculs que de maillages de triangles bruts.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-328">Convex hulls have few polygons and are free of holes, and they are much more computationally efficient to process than raw triangle meshes.</span></span>

<span data-ttu-id="ee6b2-329">Lorsque vous effectuez des raycasts sur des surfaces spatiales, gardez à l’esprit que ces surfaces sont souvent complexes, des formes encombrées de petits détails, tout comme votre bureau!</span><span class="sxs-lookup"><span data-stu-id="ee6b2-329">When performing raycasts against spatial surfaces, bear in mind that these surfaces are often complex, cluttered shapes full of messy little details - just like your desk!</span></span> <span data-ttu-id="ee6b2-330">Cela signifie qu’un seul raycast est souvent insuffisant pour vous fournir suffisamment d’informations sur la forme de la surface et la forme de l’espace vide près de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-330">This means that a single raycast is often insufficient to give you enough information about the shape of the surface and the shape of the empty space near it.</span></span> <span data-ttu-id="ee6b2-331">Il est donc généralement judicieux d’effectuer de nombreux raycasts dans une petite zone et d’utiliser les résultats d’agrégation pour obtenir une compréhension plus fiable de la surface.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-331">It is thus usually a good idea to perform many raycasts within a small area and to use the aggregate results to derive a more reliable understanding of the surface.</span></span> <span data-ttu-id="ee6b2-332">Par exemple, l’utilisation de la moyenne de 10 raycasts pour guider le placement de l’hologramme sur une surface produit un résultat beaucoup plus lisse et moins instable qui utilise simplement un raycast unique.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-332">For example, using the average of 10 raycasts to guide hologram placement on a surface will yield a far smoother and less 'jittery' result that using just a single raycast.</span></span>

<span data-ttu-id="ee6b2-333">Toutefois, gardez à l’esprit que chaque raycast peut avoir un coût de calcul élevé.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-333">However, bear in mind that each raycast can have a high computational cost.</span></span> <span data-ttu-id="ee6b2-334">Par conséquent, en fonction de votre scénario d’utilisation, vous devez compenser le coût de calcul des raycasts supplémentaires (effectuées à chaque trame) par rapport au coût de calcul du [traitement](spatial-mapping.md#mesh-processing) des maillages pour lisser et supprimer des trous dans les surfaces spatiales (effectuée quand spatial les mailles sont mises à jour).</span><span class="sxs-lookup"><span data-stu-id="ee6b2-334">Thus depending on your usage scenario you should trade off the computational cost of additional raycasts (performed every frame) against the computational cost of [mesh processing](spatial-mapping.md#mesh-processing) to smooth and remove holes in spatial surfaces (performed when spatial meshes are updated).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="ee6b2-335">Résolution des problèmes</span><span class="sxs-lookup"><span data-stu-id="ee6b2-335">Troubleshooting</span></span>
* <span data-ttu-id="ee6b2-336">Pour que les maillages de surface soient correctement orientés, chaque GameObject doit être actif avant d’être envoyé à SurfaceObeserver pour que sa maille soit construite.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-336">In order for the surface meshes to be orientated correctly, each GameObject needs to be active before it is sent to the SurfaceObeserver to have its mesh constructed.</span></span> <span data-ttu-id="ee6b2-337">Dans le cas contraire, les mailles s’affichent dans votre espace mais subissent une rotation à des angles inhabituels.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-337">Otherwise, the meshes will show up in your space but rotated at weird angles.</span></span>
* <span data-ttu-id="ee6b2-338">Le GameObject qui exécute le script qui communique avec le SurfaceObserver doit être défini sur l’origine.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-338">The GameObject that runs the script that communicates with the SurfaceObserver needs to be set to the origin.</span></span> <span data-ttu-id="ee6b2-339">Dans le cas contraire, tous les GameObjects que vous créez et envoyez au SurfaceObserver pour que leurs maillages soient construits auront un décalage égal au décalage de l’objet de jeu parent.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-339">Otherwise, all of GameObjects that you create and send to the SurfaceObserver to have their meshes constructed will have an offset equal to the offset of the Parent Game Object.</span></span> <span data-ttu-id="ee6b2-340">Cela peut faire apparaître plusieurs mètres dans vos mails, ce qui rend très difficile le débogage de ce qui se passe.</span><span class="sxs-lookup"><span data-stu-id="ee6b2-340">This can make your meshes show up several meters away which makes it very hard to debug what is going on.</span></span>

## <a name="see-also"></a><span data-ttu-id="ee6b2-341">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ee6b2-341">See also</span></span>
* [<span data-ttu-id="ee6b2-342">Systèmes de coordonnées</span><span class="sxs-lookup"><span data-stu-id="ee6b2-342">Coordinate systems</span></span>](coordinate-systems.md)
* [<span data-ttu-id="ee6b2-343">Mappage spatial dans DirectX</span><span class="sxs-lookup"><span data-stu-id="ee6b2-343">Spatial mapping in DirectX</span></span>](spatial-mapping-in-directx.md)
* [<span data-ttu-id="ee6b2-344">Mappage spatial dans Unity</span><span class="sxs-lookup"><span data-stu-id="ee6b2-344">Spatial mapping in Unity</span></span>](spatial-mapping-in-unity.md)
* [<span data-ttu-id="ee6b2-345">Conception du mappage spatial</span><span class="sxs-lookup"><span data-stu-id="ee6b2-345">Spatial mapping design</span></span>](spatial-mapping-design.md)
* [<span data-ttu-id="ee6b2-346">Compréhension des scènes</span><span class="sxs-lookup"><span data-stu-id="ee6b2-346">Scene Understanding</span></span>](scene-understanding.md)
* [<span data-ttu-id="ee6b2-347">Étude de cas - Voir à travers vos objets</span><span class="sxs-lookup"><span data-stu-id="ee6b2-347">Case study - Looking through holes in your reality</span></span>](case-study-looking-through-holes-in-your-reality.md)
